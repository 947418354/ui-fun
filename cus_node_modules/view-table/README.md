## view-table
    表格组件  
    

### 安装 
    将cus_node_modules目录下的view-table ppw-table-base ppw-common搬运 

### 引用
#### 方式一,
```
<script src="xxx/node_modules/ppw-view-table/dist/index.min.js"></script>  
```
通过全局对象window["ppw-view-table"]访问    

#### 方式二,
```
import ViewTable from "view-table"   
```

### 数据格式
#### 列数据格式 Example   
```
        let cols = [{   
            "name": "公司名称",   
            "id": "companyName", 
            "headerItemClass": "vt-header-td-companyName",
            "colClass": "vt-header-companyName",
            "colNameClass": "vt-header-name-companyName",
            "cellClass": "vt-td-companyName",  
            "dataType": "string",   
            "fat": "multiLevel",    // 调取对应的fat函数,返回值作innerHtml渲染
            "sortable": true,
            "resizable":true,
            "linkHost": "https://master-test.simuwang.com/Company",   
            "width": 300
        },{   
            "name": "市值",   
            "id": "marketValue",   
            "dataType": "number",   
            "minWidth": 100,   
            "maxWidth": 500,   
        },{   
            "name": "其它信息",   
            "id": "otherInfo",   
            "childs":[{   
                "name": "网址",   
                "id": "website",   
                "fat": "link",   
                "width": 150   
            },{   
                "name": "联系地址",   
                "id": "officeAddress",   
                "width": 130   
            },{   
                "name": "联系电话",   
                "id": "contactPhone",   
                "width": 130   
            }]   
        }]   
```

#### 行数据格式 Example   
```
        let rows = [{   
            "companyName": "重庆银行总行",   
            "marketValue": 58800000000,   
            "website": "www.cqcbank.com ",   
            "officeAddress": "重庆市渝中区邹容路153号 ",   
            "companyId": "CO00002756",   
            "contactPhone": "4007096899",  
            "marketValue_color": "#ccc", 
            "marketValue_background": "#ccc",
            "marketValue_fontSize": "12px",
            "marketValue_fontWeight": "bold",
            "sectable": 默认没有此属性，行默认可选择，如果不想被选择，将值设为false  
            "_unsort": 默认没有此属性,如果某行不参与排序, 将值设为true,将该行排在组的最下面，多行都设置了该属性为true时，则按其原有顺序排在组的最下面
            "_unsortToTop" 默认没有此属性，配合"_unsort"使用，排序时将行排在最上面
          },{   
            "companyName": "大型机构",   
            "childs": [{   
                "companyName": "中原证券股份有限公司",   
                "marketValue": 38800000000,   
                "website": "http://www.ccnew.com/",   
                "officeAddress": "郑州市郑东新区商务外环路10号",   
                "companyId": "CO0000004H",   
                "contactPhone": "0371-65585018"   
            }]   
          }, {   
            "companyName": "中型机构",   
            "childs": [{   
                "companyName": "中原银行股份有限公司",   
                "marketValue": 28800000000,   
                "website": "www.zybank.com.cn",   
                "officeAddress": "郑州市郑东新区CBD商务外环路23号中科金座大厦",   
                "companyId": "CO00000X9O",   
                "contactPhone": "96688"   
            }]   
        },{   
            "companyName": "小型机构",   
            "childs": [{
                "companyName": "中邮证券有限责任公司",   
                "marketValue": 18800000000,   
                "website": "http://www.cn/psec.com/",   
                "officeAddress": "西安高新区唐延路5号陕西邮政信息大厦",   
                "companyId": "CO000000JA",   
                "contactPhone": "029-88497232"   
            }]   
        }]   
```

### 默认选项值
```
    {   
        maxHeight: null, //Number类型， 默认为null, 设置表格最大高度，超过最大高度出现滚动条。   
        lineHeight: 34, //设置每行高度,   
        pageNum: null, //默认根据容器高度/行高,来显示行数,如果设置pageNum为数值,且大于计算出的默认值,则按pageNum值显示行数。注意,此值过大时会影响性能。慎重设置。   
        header: true, //是否显示表头,    
        fixedCol: -1, //值 < 0 则不固定列，值 >= 0 则将索引为0-值的列固定
        fixedRightCol: null,//默认null，值 > 0 时则从右向左固定列。（注意最右边列为空白列，所以想要冻结右边有效可见列，值应该 >= 2）  
        fixedRow: -1, //值 < 0 则不固定行，值 >= 0 则将索引为0-值的行固定, 最大值10   
        enRowNumber：true, //每行是否显示行号值   
        enCheckbox: true, //每行是否显示checkbox   
        enCheckboxTotal: true, //是否显示全选/全取消 checkbox   
        enCollapseTotal: true, //是否显示折叠全部/展开全部按钮   
        collapseTotal: false, //是否默认折叠全部   
        noDataText: "暂无数据!"  //当没有数据时显示的提示文字   
    }   
```

### 默认的列fat值列表
    "multiLevel", 表示该列的值将以多级结构显示   
    "link", 表示该列的值将显示为链接   
    "string", 表示该列的值将显示为字符串   
    "number", 表示该列的值将显示为数据   

### 自定义fat
```
    let fats = {   
        custom1(value, rowData, colData, rowIndex, colIndex, cellEl) {   
            //TODO   
        },   
        custom2(value, rowData, colData, rowIndex, colIndex, cellEl) {   
            //TODO   
        }   
    }   
    xxx.setFat(fats) //通过调用setFat方法设置fat   
```


### 使用
```
    let $container = $(".tableContainer")   
    let vtable = new ViewTable($container)   
    //vtable.setOpt(option); //如需改变默认选项，则通过调用setOpt设置   
    //vtable.setFat(fat); //如需改变默认fat,则通过调用setFat设置   
    vtable.setData(cols, rows);   
    vtable.render(); //第一次初始化渲染表格   
    //event   
    vtable.bind("onClick", (e, d) => {   
        let target = d.e.target   
        let rowIndex = d.rowIndex   
        let rowData = this.getRow(rowIndex)   
        //ToDO   
    })   
    // resize   
    $(window).resize(function() {   
        viewtable.resize();   
    });   
```

### 方法
#### setOpt[opts]
    设置修改默认选项值, 参数对象opts   
#### setFat[fats] 
    设置自定义fats, 参数对象fats      
#### setData[cols, rows] 
    设置列数据，行数据, 参数数组cols, 数组rows  
#### getSectRows 
    获取选中的行列表   
#### render 
    渲染表格   
#### expandTotal
    可选参数targetLevel,   
    默认无参数,展开表格所有节点, 当targetLevel为数值时则展开1至targetLevel的节点   
#### collapseTotal
    折叠表格所有节点   
#### updateRow(rowIndex)
    刷新行
#### updateCell(rowIndex, colIndex)
    刷新单元格
#### sectAll
    选择所有行的checkbox  
#### unsectAll
    取消选择所有行的checkbox  
#### reset 
    重置表格,当数据变化时需要重新初始化表格时调用此方法重置表格   
#### update 
    更新表格, 当数据变化时只需要更新表格时调用此方法更新表格   
#### resize 
    当外部容器大小发生变化时,调用此方法更新表格大小   
#### getExportHeadStr 
    获取表格头部的字符串 return html片段
    <thead><tr><td class='' rowspan='2'>
#### getExportBodyStr（onlySect, prefix, exportAll） 
    获取表格主体所有行的字符串   
    可选参数onlySect,   
    默认无参数，获取所有行生成字符串返回   
    当onlySect为true时，获取所有选中的行生成字符串返回   
    可选参数prefix,  
    默认无，设置自定义的属性前缀，通过前缀获取自定义需要导出的值 
    可选参数exportAll
    默认无，是否导出所有行  
    return
    <tbody><tr class=''><td class=''>固定列值</td>


#### destroy 
    摧毁表格   

### 事件（所有事件绑定函数均有evt, data两个参数, data.e是原始点击事件信息）
#### onRenderComplete 
    表格渲染完成后触发   
#### onCellRendered
    单元格渲染完成触发
#### onClick 
    当行被点击时触发事件   
#### onHeaderClick 
    当列头被点击时触发   
#### onHeaderMouseOver 
    列头鼠标over时触发   
#### onHeaderMouseOut 
    列头鼠标out时触发   
#### onCellMouseOver 
    单元格鼠标over时触发   
#### onCellMouseOut  
    单元格鼠标out时触发   
#### onMultiLevelClick 
    当多级结构数据的展开/折叠按钮被点击时触发   
#### onMultiLevelAllClick  
    当列头的展开全部/折叠全部按钮被点击时触发   
#### onCheckboxClick 
    当行的chekbox被点击时触发   
#### onCheckboxTotalClick 
    当列头的全选/全取消chekbox被点击时触发   


